<div class="page">
  <div class="card">
    <div class="icon-wrap" aria-hidden="true">
      <span class="icon">✦</span>
    </div>

    <h1 class="title">Criar Conta</h1>
    <p class="subtitle">Preencha os dados abaixo para criar sua conta</p>

    <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>

      <label class="label" for="nome">Nome completo</label>
      <input
        id="nome"
        type="text"
        class="input"
        placeholder="Seu nome"
        formControlName="nome"
        autocomplete="name"
      />
      @if (submitted && f.nome.invalid) {
        <small class="error">Informe seu nome completo.</small>
      }

      <label class="label" for="email">Email</label>
      <input
        id="email"
        type="email"
        class="input"
        placeholder="seuemail@email.com"
        formControlName="email"
        autocomplete="email"
      />
      @if (submitted && f.email.invalid) {
        <small class="error">Informe um email válido.</small>
      }

      <label class="label" for="senha">Senha</label>
      <div class="input-wrap">
        <input
          id="senha"
          [type]="showPassword ? 'text' : 'password'"
          class="input"
          placeholder="••••••••"
          formControlName="senha"
          autocomplete="new-password"
        />
        <button
          type="button"
          class="toggle-btn"
          (click)="togglePassword()"
          aria-label="Mostrar ou ocultar senha">
          @if (!showPassword) {
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b6f7b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
              <circle cx="12" cy="12" r="3"/>
            </svg>
          } @else {
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b6f7b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"/>
              <path d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"/>
              <line x1="1" y1="1" x2="23" y2="23"/>
            </svg>
          }
        </button>
      </div>

      <small class="hint">Mínimo de 8 caracteres, com pelo menos 1 letra maiúscula</small>

      @if (submitted && f.senha.hasError('required')) {
        <small class="error">A senha é obrigatória.</small>
      } @else if (submitted && f.senha.hasError('minlength')) {
        <small class="error">A senha deve ter no mínimo 8 caracteres.</small>
      } @else if (submitted && f.senha.hasError('noUppercase')) {
        <small class="error">A senha deve conter pelo menos 1 letra maiúscula.</small>
      }

      <label class="label" for="confirmar">Confirmar senha</label>
      <div class="input-wrap">
        <input
          id="confirmar"
          [type]="showConfirmPassword ? 'text' : 'password'"
          class="input"
          placeholder="••••••••"
          formControlName="confirmSenha"
          autocomplete="new-password"
        />
        <button
          type="button"
          class="toggle-btn"
          (click)="toggleConfirmPassword()"
          aria-label="Mostrar ou ocultar confirmação de senha">
          @if (!showConfirmPassword) {
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b6f7b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
              <circle cx="12" cy="12" r="3"/>
            </svg>
          } @else {
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b6f7b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"/>
              <path d="M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"/>
              <line x1="1" y1="1" x2="23" y2="23"/>
            </svg>
          }
        </button>
      </div>

      @if (submitted && (f.confirmSenha.invalid || form.hasError('passwordMismatch'))) {
        <small class="error">As senhas não coincidem.</small>
      }

      <label class="terms">
        <input type="checkbox" formControlName="terms" />
        <span>Concordo com os <a class="link" href="#">termos de serviço</a> e <a class="link" href="#">política de privacidade</a></span>
      </label>

      @if (submitted && f.terms.invalid) {
        <small class="error">Você precisa aceitar os termos.</small>
      }

      @if (errorMessage) {
        <small class="error api-error">{{ errorMessage }}</small>
      }

      <button class="btn" type="submit" [disabled]="loading">
        @if (loading) { Criando conta... } @else { Criar conta }
      </button>
    </form>

    <p class="footer">
      Já tem uma conta?
      <a class="link" routerLink="/login">Fazer login</a>
    </p>
  </div>
</div>